<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VILL: High-Fidelity Prototype</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-orbit-controls@1.3.0/dist/aframe-orbit-controls.min.js"></script>
  
  <style>
    /* Google Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Teko:wght@300;500&family=Roboto:wght@300;700&display=swap');
    
    body { margin: 0; overflow: hidden; font-family: 'Roboto', sans-serif; }

    /* === UI 層 === */
    #ui-layer {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    /* 頂部標題 */
    .header {
      padding: 20px;
      background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, transparent 100%);
      color: #00f3ff;
      font-family: 'Teko', sans-serif;
      font-size: 32px;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
    }

    /* 右側資料面板 */
    #info-card {
      position: absolute;
      top: 100px; right: 30px;
      width: 320px;
      background: rgba(10, 20, 30, 0.9);
      border: 1px solid rgba(0, 243, 255, 0.3);
      border-left: 4px solid #00f3ff;
      backdrop-filter: blur(10px);
      padding: 20px;
      color: white;
      transform: translateX(120%);
      transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
      pointer-events: auto;
    }
    #info-card.active { transform: translateX(0); }

    .card-title { font-family: 'Teko', sans-serif; font-size: 28px; color: #00f3ff; border-bottom: 1px solid #333; margin-bottom: 10px; }
    .card-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #ccc; }
    .card-val { color: #fff; font-weight: bold; }
    .card-desc { font-size: 13px; color: #889; margin-top: 15px; line-height: 1.4; }

    /* 載入畫面 */
    #loader {
      position: absolute; top:0; left:0; width:100%; height:100%;
      background: #000; z-index: 9999;
      display: flex; justify-content: center; align-items: center;
      color: #00f3ff; font-family: 'Teko', sans-serif; font-size: 24px;
      transition: opacity 0.5s;
    }
  </style>
</head>

<body>

  <div id="loader">LOADING VILL ENVIRONMENT...</div>

  <div id="ui-layer">
    <div class="header">VILL SYSTEM: VIETNAM STRATEGY MAP</div>
    
    <div id="info-card">
      <div class="card-title" id="c-title">DATA NODE</div>
      <div id="c-content"></div>
    </div>
  </div>

  <a-scene renderer="antialias: true; colorManagement: true; highRefreshRate: true;" cursor="rayOrigin: mouse" raycaster="objects: .clickable">
    
    <a-assets>
      <img id="room-tex" src="https://live.staticflickr.com/65535/52285608679_2003c44158_k.jpg" crossorigin="anonymous">
      
      <img id="map-tex" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Vietnam_location_map_topographic.png/800px-Vietnam_location_map_topographic.png" crossorigin="anonymous">
      
      <img id="wood-tex" src="https://cdn.glitch.global/2a3af8bb-e7b2-4e50-8ce2-68e3e8cf4538/wood.jpg?v=1603223030300" crossorigin="anonymous">
    </a-assets>

    <a-sky src="#room-tex" rotation="0 -90 0" color="#888"></a-sky>

    <a-light type="ambient" color="#fff" intensity="0.4"></a-light>
    <a-light type="spot" position="0 4 0" target="#table-center" intensity="0.8" penumbra="0.5" castShadow="true"></a-light>
    <a-light type="point" position="2 3 2" intensity="0.5" color="#00f3ff"></a-light>

    <a-entity camera orbit-controls="target: 0 0.8 0; minDistance: 1.5; maxDistance: 4; initialPosition: 0 1.8 2.5"></a-entity>

    <a-entity id="table-center" position="0 0 0">
      <a-cylinder radius="1.4" height="0.05" position="0 0.8 0" src="#wood-tex" color="#8d6e63" material="roughness: 0.8"></a-cylinder>
      <a-cylinder radius="0.15" height="0.8" position="0 0.4 0" color="#3e2723"></a-cylinder>
      <a-cylinder radius="0.6" height="0.02" position="0 0.01 0" color="#3e2723"></a-cylinder>
    </a-entity>

    <a-entity id="paper-map" position="0 0.83 0.3" rotation="-90 0 0">
      <a-plane width="0.8" height="1.1" color="#fff" shadow="cast: true"></a-plane>
      <a-image src="#map-tex" width="0.7" height="1" position="0 0 0.01" opacity="0.8"></a-image>
      <a-plane width="0.8" height="1.1" color="#000" opacity="0.0" class="clickable"
               animation__hover="property: scale; to: 1.05 1.05 1; dur: 200; startEvents: mouseenter; pauseEvents: mouseleave">
        <a-text value="CLICK TO ACTIVATE" align="center" color="#d50000" width="4" position="0 0 0.05" font="mozillavr"></a-text>
      </a-plane>
    </a-entity>

    <a-entity id="hologram-group" position="0 0.85 0" visible="false" scale="0 0 0">
      
      <a-box width="1.4" height="0.05" depth="2.0" color="#000" opacity="0.9" position="0 0.025 0"></a-box>
      <a-plane width="1.4" height="2.0" rotation="-90 0 0" position="0 0.06 0" color="#00f3ff" material="src: #map-tex; opacity: 0.2"></a-plane>
      
      <a-image 
        src="#map-tex" 
        width="1.2" height="1.8" 
        rotation="-90 0 0" 
        position="0 0.2 0"
        material="opacity: 0.95; transparent: true">
      </a-image>

      <a-entity position="0.1 0.25 -0.4" class="clickable pin" data-id="samsung">
        <a-sphere radius="0.04" color="#ff1744" position="0 0.1 0">
           <a-animation attribute="material.emissive" from="#000" to="#500" dur="1000" dir: alternate; loop: true></a-animation>
        </a-sphere>
        <a-cone radius-bottom="0.005" radius-top="0.04" height="0.1" color="#ff1744" position="0 0.05 0"></a-cone>
        <a-cylinder radius="0.005" height="1" color="#ff1744" position="0 0.5 0" opacity="0.3"></a-cylinder>
      </a-entity>

      <a-entity position="0.25 0.25 -0.35" class="clickable pin" data-id="apple">
        <a-sphere radius="0.04" color="#fff" position="0 0.1 0"></a-sphere>
        <a-cone radius-bottom="0.005" radius-top="0.04" height="0.1" color="#fff" position="0 0.05 0"></a-cone>
        <a-cylinder radius="0.005" height="1" color="#fff" position="0 0.5 0" opacity="0.3"></a-cylinder>
      </a-entity>

      <a-entity position="0.5 0.25 0.1" class="clickable pin" data-id="port">
        <a-sphere radius="0.04" color="#00f3ff" position="0 0.1 0"></a-sphere>
        <a-cone radius-bottom="0.005" radius-top="0.04" height="0.1" color="#00f3ff" position="0 0.05 0"></a-cone>
        <a-cylinder radius="0.005" height="1" color="#00f3ff" position="0 0.5 0" opacity="0.3"></a-cylinder>
      </a-entity>

      <a-entity line="start: 0.1 0.25 -0.4; end: 0.5 0.25 0.1; color: #ffeb3b; opacity: 0.6"></a-entity>
      
    </a-entity>

  </a-scene>

  <script>
    // 移除 Loading
    document.querySelector('a-scene').addEventListener('loaded', () => {
      document.getElementById('loader').style.opacity = '0';
      setTimeout(() => document.getElementById('loader').remove(), 500);
    });

    // 資料庫
    const db = {
      samsung: {
        title: 'SAMSUNG (Bac Ninh)',
        html: `
          <div class="card-row"><span>Investment</span> <span class="card-val">$19.2B</span></div>
          <div class="card-row"><span>Contribution</span> <span class="card-val">18% of GDP</span></div>
          <div class="card-desc">北寧省是三星全球最大的生產基地。此處的地理優勢在於距離內排國際機場 (Noi Bai Airport) 僅 40 分鐘車程。</div>
        `
      },
      apple: {
        title: 'APPLE / LUXSHARE',
        html: `
          <div class="card-row"><span>Location</span> <span class="card-val">Bac Giang</span></div>
          <div class="card-row"><span>Product</span> <span class="card-val">iPad / Watch</span></div>
          <div class="card-desc">為分散中國供應鏈風險，Apple 指示富士康與立訊精密在此擴建產線。</div>
        `
      },
      port: {
        title: 'HAI PHONG PORT',
        html: `
          <div class="card-row"><span>Type</span> <span class="card-val">Deep Sea Port</span></div>
          <div class="card-row"><span>Logistics</span> <span class="card-val">Key Gateway</span></div>
          <div class="card-desc">連接 Lach Huyen 深水港，是北越電子產品出口至歐美市場的唯一海運咽喉。</div>
        `
      }
    };

    // 互動邏輯
    const paperMap = document.getElementById('paper-map');
    const hologram = document.getElementById('hologram-group');
    const card = document.getElementById('info-card');
    const cTitle = document.getElementById('c-title');
    const cContent = document.getElementById('c-content');

    // 1. 點擊桌上的紙地圖
    paperMap.addEventListener('click', () => {
      // 紙地圖消失
      paperMap.setAttribute('visible', 'false');
      // 全息地圖出現
      hologram.setAttribute('visible', 'true');
      hologram.setAttribute('animation', 'property: scale; from: 0 0 0; to: 1 1 1; dur: 1000; easing: easeOutBack');
    });

    // 2. 點擊標記
    document.querySelectorAll('.pin').forEach(pin => {
      pin.addEventListener('click', function(evt) {
        evt.stopPropagation();
        const id = this.getAttribute('data-id');
        const data = db[id];

        cTitle.innerText = data.title;
        cContent.innerHTML = data.html;
        card.classList.add('active');
      });
    });

    // 點擊背景關閉
    document.querySelector('a-scene').addEventListener('click', (evt) => {
      if (!evt.target.classList.contains('clickable')) {
        card.classList.remove('active');
      }
    });
  </script>
</body>
</html>
