<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VILL: North Vietnam Strategy (V14 Final)</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-orbit-controls@1.3.0/dist/aframe-orbit-controls.min.js"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&family=Noto+Sans+TC:wght@400;700&display=swap');
    body { margin: 0; overflow: hidden; font-family: 'Noto Sans TC', sans-serif; background-color: #1a1a1a; }

    /* UI å±¤ä¿æŒä¸è®Š */
    #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; display: flex; flex-direction: column; justify-content: space-between; }
    .header { background: rgba(10, 20, 30, 0.95); border-bottom: 3px solid #00d2ff; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; pointer-events: auto; }
    .title { color: #00d2ff; font-family: 'Rajdhani', sans-serif; font-size: 28px; font-weight: bold; letter-spacing: 2px; }
    .subtitle { color: #fff; font-size: 14px; margin-left: 15px; opacity: 0.8; }
    #info-panel { position: absolute; top: 120px; right: 30px; width: 340px; background: rgba(16, 24, 32, 0.98); border: 1px solid #444; border-left: 6px solid #00d2ff; border-radius: 8px; padding: 25px; color: white; transform: translateX(130%); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); pointer-events: auto; box-shadow: -10px 10px 40px rgba(0,0,0,0.6); }
    #info-panel.active { transform: translateX(0); }
    .panel-h { color: #00d2ff; font-size: 22px; font-weight: bold; margin-bottom: 12px; border-bottom: 1px solid #555; padding-bottom: 8px; font-family: 'Rajdhani'; }
    .panel-b { font-size: 15px; line-height: 1.6; color: #ddd; }
    .tag { display: inline-block; background: #004d40; color: #00d2ff; padding: 3px 8px; border-radius: 4px; font-size: 12px; margin-bottom: 10px; }
    .close-btn { position: absolute; top: 10px; right: 10px; color: #777; cursor: pointer; font-weight: bold; font-family: sans-serif; } .close-btn:hover { color: white; }
    .controls-hint { text-align: center; padding: 15px; background: linear-gradient(0deg, rgba(0,0,0,0.9), transparent); color: #aaa; font-size: 13px; }
  </style>

  <script>
    // === Look-At Component ===
    AFRAME.registerComponent('look-at-camera', {
      tick: function () { this.el.object3D.lookAt(this.el.sceneEl.camera.el.object3D.position); }
    });
  </script>

</head>

<body>

  <div id="ui-layer">
    <div class="header">
      <div><span class="title">VILL SYSTEM</span><span class="subtitle">Module: North Vietnam Supply Chain</span></div>
      <div style="background:#00d2ff; color:black; font-size:12px; padding:4px 10px; border-radius:4px; font-weight:bold;">LIVE</div>
    </div>
    <div id="info-panel">
      <div class="close-btn" onclick="closePanel()">âœ•</div>
      <div class="panel-h" id="p-title">Data Node</div>
      <div class="panel-b" id="p-content">...</div>
    </div>
    <div class="controls-hint">ğŸ–±ï¸ å·¦éµæ‹–æ›³: æ—‹è½‰ | ğŸ–±ï¸ æ»¾è¼ª: ç¸®æ”¾ | ğŸ–±ï¸ å³éµæ‹–æ›³: å¹³ç§» | ğŸ‘† è«‹é»æ“Šåœ°åœ–ä¸Šçš„æ¨™è¨˜</div>
  </div>

  <a-scene renderer="antialias: true; colorManagement: true;" cursor="rayOrigin: mouse" raycaster="objects: .clickable">
    
    <a-assets>
      <img id="map-tex" src="./map.jpg" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Vietnam_location_map_topographic.png/640px-Vietnam_location_map_topographic.png'">
      <canvas id="wood-tex" width="512" height="512"></canvas>
    </a-assets>

    <a-sky color="#0f172a"></a-sky>
    <a-entity id="room">
      <a-plane position="0 0 0" rotation="-90 0 0" width="30" height="30" color="#334155"></a-plane>
      <a-plane position="0 6 0" rotation="90 0 0" width="30" height="30" color="#1e293b"></a-plane>
      <a-plane position="0 3 -8" width="30" height="6" color="#cbd5e1"></a-plane>
      <a-plane position="-8 3 0" rotation="0 90 0" width="30" height="6" color="#94a3b8"></a-plane>
      <a-plane position="8 3 0" rotation="0 -90 0" width="30" height="6" color="#94a3b8"></a-plane>
      <a-plane position="-7.9 3 0" rotation="0 90 0" width="6" height="3" color="#fff" material="emissive:#fff; emissiveIntensity:0.6"></a-plane>
    </a-entity>
    <a-light type="ambient" intensity="0.5"></a-light>
    <a-light type="directional" position="-5 5 2" intensity="0.6" castShadow="true"></a-light>
    <a-light type="spot" position="0 7 0" target="#table" intensity="1.2" penumbra="0.4"></a-light>

    <a-entity id="table" position="0 0 0">
      <a-cylinder position="0 0.8 0" radius="2" height="0.1" material="src: #wood-tex; color: #3e2723; roughness: 0.5"></a-cylinder>
      <a-cylinder position="0 0.4 0" radius="0.3" height="0.8" color="#222"></a-cylinder>
      <a-cylinder position="0 0.02 0" radius="1.0" height="0.05" color="#111"></a-cylinder>
      <a-torus position="0 0.8 0" rotation="90 0 0" radius="2" radius-tubular="0.015" color="#00d2ff" material="emissive:#00d2ff; emissiveIntensity:0.8"></a-torus>
    </a-entity>

    <a-entity id="step1-flat" position="0 0.86 0" rotation="-90 0 0">
      <a-plane width="1.4" height="2" color="#fff" class="clickable" onclick="activateAR()">
        <a-image src="#map-tex" width="1.3" height="1.9" position="0 0 0.01"></a-image>
        <a-plane width="1.4" height="2" position="0 0 0.02" color="#00d2ff" opacity="0" animation__hover="property: opacity; from: 0; to: 0.2; dur: 200; startEvents: mouseenter; pauseEvents: mouseleave"></a-plane>
        <a-text value="CLICK TO ACTIVATE" align="center" position="0 0 0.05" color="red" scale="1 1 1"></a-text>
      </a-plane>
    </a-entity>

    <a-entity id="step2-ar" position="0 1.2 0" visible="false" scale="0.1 0.1 0.1">
      <a-image src="#map-tex" width="1.8" height="2.6" rotation="-90 0 0" opacity="0.95"></a-image>
      <a-plane width="1.8" height="0.05" rotation="-90 0 0" color="#00d2ff" opacity="0.3" position="0 0.05 0">
         <a-animation attribute="position" from="0 0.05 -1" to="0 0.05 1" dur="2500" dir="alternate" repeat="indefinite"></a-animation>
      </a-plane>

      <a-entity position="0.45 0.1 -0.9" class="clickable pin" data-id="samsung">
        <a-box visible="false" width="0.3" height="0.5" depth="0.3" position="0 0.1 0"></a-box>
        <a-sphere radius="0.06" color="#ff0055" position="0 0.15 0">
           <a-animation attribute="scale" to="1.2 1.2 1.2" dur="800" dir="alternate" repeat="indefinite"></a-animation>
        </a-sphere>
        <a-cone radius-bottom="0.01" radius-top="0.06" height="0.15" color="#ff0055" position="0 0.075 0"></a-cone>
        
        <a-entity position="0 0.45 0" look-at-camera>
          <a-plane color="black" opacity="0.8" width="1.2" height="0.35"></a-plane>
          <a-text value="SAMSUNG" align="center" color="#fff" width="4" position="0 0 0.01"></a-text>
        </a-entity>
      </a-entity>

      <a-entity position="0.3 0.1 -0.7" class="clickable pin" data-id="apple">
        <a-box visible="false" width="0.3" height="0.5" depth="0.3" position="0 0.1 0"></a-box>
        <a-sphere radius="0.06" color="#ffffff" position="0 0.15 0"></a-sphere>
        <a-cone radius-bottom="0.01" radius-top="0.06" height="0.15" color="#ffffff" position="0 0.075 0"></a-cone>
        
        <a-entity position="0 0.45 0" look-at-camera>
          <a-plane color="black" opacity="0.8" width="1.0" height="0.35"></a-plane>
          <a-text value="APPLE" align="center" color="#fff" width="4" position="0 0 0.01"></a-text>
        </a-entity>
      </a-entity>

    </a-entity>

    <a-entity camera look-controls="enabled: false" orbit-controls="target: 0 0.8 0; minDistance: 0.1; maxDistance: 10; initialPosition: 0 2 3.5; rotateSpeed: 0.5; zoomSpeed: 2.0; enableZoom: true; enablePan: true; screenSpacePanning: true;"></a-entity>
  </a-scene>

  <script>
    const ctx = document.getElementById('wood-tex').getContext('2d');
    ctx.fillStyle = '#3e2723'; ctx.fillRect(0,0,512,512); ctx.strokeStyle = '#2e1c18'; ctx.lineWidth = 4; for(let i=0;i<40;i++){ctx.beginPath();ctx.moveTo(0,Math.random()*512);ctx.bezierCurveTo(150,Math.random()*512,350,Math.random()*512,512,Math.random()*512);ctx.stroke();}

    const flat = document.getElementById('step1-flat');
    const ar = document.getElementById('step2-ar');
    const panel = document.getElementById('info-panel');
    const pTitle = document.getElementById('p-title');
    const pContent = document.getElementById('p-content');

    window.activateAR = function() {
      flat.setAttribute('visible', 'false'); ar.setAttribute('visible', 'true');
      ar.setAttribute('animation', 'property: scale; to: 1 1 1; dur: 1000; easing: easeOutElastic');
    };
    window.closePanel = function() { panel.classList.remove('active'); };

    const db = {
      samsung: { title: "SAMSUNG ELECTRONICS", body: "<span class='tag'>LOCATION: BAC NINH</span><br><br><b>æŠ•è³‡è¦æ¨¡:</b> $19.2 Billion<br><b>é—œéµåœ°ä½:</b> å…¨çƒ 50% çš„ Galaxy æ‰‹æ©Ÿåœ¨æ­¤ç”Ÿç”¢ã€‚<br><b>åœ°ç†å„ªå‹¢:</b> è·é›¢å…§æ’æ©Ÿå ´ (Noi Bai) åƒ… 40 åˆ†é˜ï¼Œæ–¹ä¾¿ç©ºé‹å‡ºå£ã€‚" },
      apple: { title: "APPLE / FOXCONN", body: "<span class='tag'>LOCATION: BAC GIANG</span><br><br><b>ä¸»è¦ç”¢å“:</b> iPad, Apple Watch<br><b>æˆ°ç•¥æ„ç¾©:</b> Apple ä¾›æ‡‰éˆå»é¢¨éšªåŒ– (De-risking) çš„æ ¸å¿ƒã€‚æ­£é€æ­¥å°‡ MacBook ç”¢ç·šç§»å…¥æ­¤å€ã€‚" }
    };

    document.querySelectorAll('.pin').forEach(pin => {
      pin.addEventListener('click', function(e) {
        e.stopPropagation(); const data = db[this.getAttribute('data-id')];
        pTitle.innerHTML = data.title; pContent.innerHTML = data.body; panel.classList.add('active');
      });
      pin.addEventListener('mouseenter', function() { this.object3D.scale.set(1.3, 1.3, 1.3); document.body.style.cursor = 'pointer'; });
      pin.addEventListener('mouseleave', function() { this.object3D.scale.set(1, 1, 1); document.body.style.cursor = 'default'; });
    });
  </script>
</body>
</html>

