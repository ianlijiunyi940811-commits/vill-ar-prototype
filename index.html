<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VILL: Classroom Sim (No Assets)</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  
  <style>
    /* UI 風格設定 */
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    body { font-family: 'Roboto', sans-serif; margin: 0; overflow: hidden; }

    /* HUD 介面 */
    #hud {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .top-banner {
      background: rgba(0,0,0,0.8);
      color: #00e5ff;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      letter-spacing: 2px;
      border-bottom: 2px solid #00e5ff;
    }

    /* 右側資料面板 */
    #info-panel {
      position: absolute;
      top: 80px; right: 20px;
      width: 300px;
      background: rgba(20, 30, 40, 0.95);
      border: 1px solid #aaa;
      border-left: 5px solid #00e5ff;
      padding: 20px;
      color: white;
      border-radius: 5px;
      transform: translateX(120%); /* 預設隱藏 */
      transition: transform 0.3s ease-out;
      pointer-events: auto;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }
    #info-panel.show { transform: translateX(0); }

    .panel-header { font-size: 20px; font-weight: bold; color: #00e5ff; margin-bottom: 10px; border-bottom: 1px solid #555; padding-bottom: 5px; }
    .panel-body { font-size: 14px; line-height: 1.6; color: #ddd; }
    
    .instruction {
      text-align: center;
      padding: 20px;
      color: yellow;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      font-size: 14px;
    }
  </style>
</head>

<body>
  <div id="hud">
    <div class="top-banner">VILL CLASSROOM SIMULATION</div>
    
    <div id="info-panel">
      <div class="panel-header" id="p-title">Data</div>
      <div class="panel-body" id="p-content">Content</div>
    </div>

    <div class="instruction">
      滑鼠拖曳旋轉視角 • 點擊桌上地圖開啟模型 • 點擊標記查看數據
    </div>
  </div>

  <a-scene cursor="rayOrigin: mouse" raycaster="objects: .clickable">
    
    <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#546e7a"></a-plane>
    <a-plane position="0 5 0" rotation="90 0 0" width="20" height="20" color="#eeeeee"></a-plane>
    <a-plane position="0 2.5 -5" width="20" height="5" color="#cfd8dc"></a-plane> <a-plane position="0 2.5 5" rotation="0 180 0" width="20" height="5" color="#cfd8dc"></a-plane> <a-plane position="-5 2.5 0" rotation="0 90 0" width="20" height="5" color="#b0bec5"></a-plane> <a-plane position="5 2.5 0" rotation="0 -90 0" width="20" height="5" color="#b0bec5"></a-plane> <a-light type="ambient" color="#fff" intensity="0.6"></a-light>
    <a-light type="point" position="0 4 0" intensity="0.8" castShadow="true"></a-light>

    <a-entity position="0 0 -2">
      <a-cylinder position="0 0.8 0" radius="1.2" height="0.05" color="#5d4037"></a-cylinder>
      <a-cylinder position="0 0.4 0" radius="0.1" height="0.8" color="#3e2723"></a-cylinder>
      <a-cylinder position="0 0.02 0" radius="0.6" height="0.05" color="#3e2723"></a-cylinder>

      <a-entity id="flat-map-group" position="0 0.83 0" rotation="-90 0 0">
        <a-plane width="1" height="1.4" color="#fff" class="clickable" id="trigger-map">
          <a-text value="VIETNAM STRATEGY MAP" color="black" align="center" position="0 0.6 0" scale="0.4 0.4 0.4"></a-text>
          <a-plane color="#e3f2fd" width="0.8" height="1" position="0 -0.1 0.01"></a-plane>
          <a-text value="CLICK TO OPEN 3D VIEW" color="red" align="center" position="0 0 0.02" scale="0.5 0.5 0.5"></a-text>
        </a-plane>
      </a-entity>

      <a-entity id="ar-map-group" position="0 0.85 0" visible="false" scale="0.1 0.1 0.1">
        
        <a-box position="0 0.05 0" width="1.2" height="0.1" depth="1.6" color="#000" opacity="0.8"></a-box>
        <a-plane position="0 0.11 0" rotation="-90 0 0" width="1.1" height="1.5" color="#00e5ff" material="wireframe:true"></a-plane>
        
        <a-box position="0 0.15 0" width="1.0" height="0.02" depth="1.4" color="#01579b"></a-box>
        <a-box position="-0.1 0.16 0" width="0.6" height="0.02" depth="1.2" color="#2e7d32"></a-box>

        <a-entity position="0 0.2 -0.4" class="clickable pin" data-type="samsung">
          <a-cone color="#ff1744" radius-bottom="0.01" radius-top="0.06" height="0.15" position="0 0.075 0"></a-cone>
          <a-sphere color="#ff1744" radius="0.06" position="0 0.15 0"></a-sphere>
          <a-text value="SAMSUNG" align="center" position="0 0.3 0" scale="0.4 0.4 0.4" color="white" look-at="#camera"></a-text>
        </a-entity>

        <a-entity position="0.2 0.2 -0.3" class="clickable pin" data-type="apple">
          <a-cone color="#ffffff" radius-bottom="0.01" radius-top="0.06" height="0.15" position="0 0.075 0"></a-cone>
          <a-sphere color="#ffffff" radius="0.06" position="0 0.15 0"></a-sphere>
          <a-text value="APPLE" align="center" position="0 0.3 0" scale="0.4 0.4 0.4" color="white" look-at="#camera"></a-text>
        </a-entity>

        <a-entity position="0.4 0.2 0" class="clickable pin" data-type="port">
          <a-cone color="#00e5ff" radius-bottom="0.01" radius-top="0.06" height="0.15" position="0 0.075 0"></a-cone>
          <a-sphere color="#00e5ff" radius="0.06" position="0 0.15 0"></a-sphere>
          <a-text value="PORT" align="center" position="0 0.3 0" scale="0.4 0.4 0.4" color="white" look-at="#camera"></a-text>
        </a-entity>

      </a-entity>
    </a-entity>

    <a-entity id="camera" camera look-controls position="0 1.6 0.5" rotation="-20 0 0"></a-entity>

  </a-scene>

  <script>
    // 簡單的 look-at 實作 (讓文字面向攝影機)
    AFRAME.registerComponent('look-at', {
      schema: { type: 'selector' },
      tick: function () {
        this.el.object3D.lookAt(this.data.object3D.position);
      }
    });

    const flatMapGroup = document.querySelector('#flat-map-group');
    const triggerMap = document.querySelector('#trigger-map');
    const arMapGroup = document.querySelector('#ar-map-group');
    
    const infoPanel = document.querySelector('#info-panel');
    const pTitle = document.querySelector('#p-title');
    const pContent = document.querySelector('#p-content');

    // 資料庫
    const db = {
      samsung: { 
        title: 'SAMSUNG (Bac Ninh)', 
        text: '投資額: 190億美元\n員工: 4萬人\n產出: 全球50% Galaxy手機\n\n北越關鍵經濟樞紐，享有特殊稅務優惠。' 
      },
      apple: { 
        title: 'APPLE (Bac Giang)', 
        text: '合作夥伴: Luxshare, Foxconn\n產品: iPad, Apple Watch\n\n供應鏈去風險化(China Plus One)的核心基地。' 
      },
      port: { 
        title: 'HAI PHONG PORT', 
        text: '類型: 深水國際港\n吞吐量: 9200萬噸/年\n\n連接北越工業區與歐美市場的唯一出口咽喉。' 
      }
    };

    // 1. 點擊平面地圖 -> 開啟 3D 地圖
    triggerMap.addEventListener('click', () => {
      // 隱藏平面
      flatMapGroup.setAttribute('visible', 'false');
      // 顯示立體
      arMapGroup.setAttribute('visible', 'true');
      // 簡單動畫效果 (變大)
      arMapGroup.setAttribute('animation', 'property: scale; to: 1 1 1; dur: 1000; easing: easeOutElastic');
    });

    // 2. 點擊標記 (Pins)
    document.querySelectorAll('.pin').forEach(pin => {
      pin.addEventListener('click', function(evt) {
        // 取得資料
        const type = this.getAttribute('data-type');
        const data = db[type];
        
        // 更新 UI
        pTitle.innerText = data.title;
        pContent.innerText = data.text;
        infoPanel.classList.add('show');

        // Pin 跳動一下
        const currentPos = this.getAttribute('position');
        const jumpPos = {x: currentPos.x, y: currentPos.y + 0.1, z: currentPos.z};
        this.setAttribute('animation', `property: position; to: ${jumpPos.x} ${jumpPos.y} ${jumpPos.z}; dur: 200; dir: alternate; loop: 2`);
      });
    });
    
    // 點擊背景關閉面板
    document.querySelector('a-scene').addEventListener('click', (evt) => {
       // 如果點擊的不是 .clickable 物件，則關閉面板
       if (!evt.target.classList.contains('clickable')) {
         infoPanel.classList.remove('show');
       }
    });

  </script>
</body>
</html>
