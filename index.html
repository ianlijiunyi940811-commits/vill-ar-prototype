<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VILL: 2026 Strategy Room</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-orbit-controls@1.3.0/dist/aframe-orbit-controls.min.js"></script>
  
  <style>
    /* 專業教育風格字體 */
    @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Noto+Sans+TC:wght@400;700&display=swap');
    
    body { margin: 0; overflow: hidden; background-color: #0b1015; font-family: 'Noto Sans TC', sans-serif; }

    /* === UI 層 === */
    #ui-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 999;
      display: flex; flex-direction: column; justify-content: space-between;
    }

    /* 頂部標題 */
    .header {
      background: rgba(10, 25, 40, 0.95);
      border-bottom: 2px solid #00d2ff;
      padding: 15px 30px;
      display: flex; justify-content: space-between; align-items: center;
      backdrop-filter: blur(10px);
    }
    .title-text { font-family: 'Rajdhani', sans-serif; font-size: 24px; color: #00d2ff; letter-spacing: 2px; font-weight: bold; }
    .subtitle { color: #8899a6; font-size: 14px; margin-left: 10px; }
    .badge { background: #00d2ff; color: #000; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }

    /* 右側資料卡 (互動跳出) */
    #info-card {
      position: absolute; top: 100px; right: 20px; width: 320px;
      background: rgba(15, 23, 30, 0.95);
      border: 1px solid #334;
      border-left: 5px solid #00d2ff;
      border-radius: 8px;
      padding: 20px;
      color: white;
      transform: translateX(120%); /* 隱藏 */
      transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
      pointer-events: auto;
      box-shadow: -10px 10px 30px rgba(0,0,0,0.5);
    }
    #info-card.active { transform: translateX(0); }

    .card-head { font-family: 'Rajdhani'; font-size: 22px; color: #00d2ff; margin-bottom: 10px; border-bottom: 1px solid #334; padding-bottom: 8px; }
    .card-body { font-size: 14px; line-height: 1.6; color: #ccc; }
    .highlight { color: white; font-weight: bold; }

    /* 底部提示 */
    .footer { text-align: center; padding: 10px; color: #667; font-size: 12px; background: rgba(0,0,0,0.8); }

    /* 錯誤提示 */
    #err-msg { position: absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:red; background:white; padding:20px; display:none; pointer-events:auto; text-align:center; }
  </style>
</head>

<body>
  
  <div id="err-msg">
    <h3>MISSING MAP.JPG</h3>
    <p>請確認您的資料夾中有 <b>map.jpg</b> 檔案。</p>
    <button onclick="location.reload()">重試</button>
  </div>

  <div id="ui-overlay">
    <div class="header">
      <div>
        <span class="title-text">VILL SYSTEM</span>
        <span class="subtitle">Vietnam Semiconductor Strategy</span>
      </div>
      <span class="badge">LIVE SIMULATION</span>
    </div>

    <div id="info-card">
      <div class="card-head" id="n-title">Data Node</div>
      <div class="card-body" id="n-content">Select a cluster...</div>
    </div>

    <div class="footer">
      [ 滑鼠左鍵 ] 旋轉視角 &nbsp;•&nbsp; [ 滾輪 ] 縮放 &nbsp;•&nbsp; [ 點擊 ] 標記互動
    </div>
  </div>

  <a-scene renderer="antialias: true; colorManagement: true;" cursor="rayOrigin: mouse" raycaster="objects: .clickable">
    
    <a-assets>
      <img id="map-tex" src="./map.jpg" onerror="document.getElementById('err-msg').style.display='block'">
      <canvas id="wood-tex" width="512" height="512"></canvas>
    </a-assets>

    <a-sky color="#1b2631"></a-sky>
    
    <a-box position="0 3 0" width="15" height="6" depth="15" material="color: #f0f2f5; side: back;"></a-box>
    <a-plane position="0 0.01 0" rotation="-90 0 0" width="15" height="15" color="#e1e4e8"></a-plane>
    <a-plane position="-7.4 3 0" rotation="0 90 0" width="6" height="3" color="#fff" material="emissive: #fff; emissiveIntensity: 0.6"></a-plane>

    <a-light type="ambient" intensity="0.6"></a-light>
    <a-light type="directional" position="-5 5 0" intensity="0.5" castShadow="true"></a-light>
    <a-light type="spot" position="0 6 0" target="#table" intensity="0.8" penumbra="0.5"></a-light>


    <a-entity id="table" position="0 0 0">
      <a-cylinder position="0 0.8 0" radius="1.6" height="0.05" material="src: #wood-tex; color: #3e2723; roughness: 0.6"></a-cylinder>
      <a-cylinder position="0 0.4 0" radius="0.2" height="0.8" color="#222"></a-cylinder>
      <a-cylinder position="0 0.02 0" radius="0.8" height="0.05" color="#111"></a-cylinder>
    </a-entity>


    <a-entity position="0 0.84 0" rotation="-90 0 0">
      
      <a-image src="#map-tex" width="2" height="2" position="0 0 0.01"></a-image>
      
      <a-plane width="2" height="0.02" color="#00d2ff" opacity="0.5" position="0 0 0.02">
        <a-animation attribute="position" from="0 -1 0.02" to="0 1 0.02" dur="3000" dir="alternate" repeat="indefinite"></a-animation>
      </a-plane>


      <a-entity position="-0.2 0.5 0.1" class="clickable pin" data-id="samsung">
         <a-ring radius-inner="0.04" radius-outer="0.05" color="#ff0055">
           <a-animation attribute="scale" to="2 2 1" dur="1500" repeat="indefinite"></a-animation>
           <a-animation attribute="material.opacity" from="1" to="0" dur="1500" repeat="indefinite"></a-animation>
         </a-ring>
         <a-cone radius-bottom="0.01" radius-top="0.05" height="0.15" color="#ff0055" rotation="90 0 0"></a-cone>
         <a-text value="Samsung" align="center" position="0 -0.15 0.2" scale="0.5 0.5 0.5" color="white"></a-text>
      </a-entity>

      <a-entity position="0.3 0.1 0.1" class="clickable pin" data-id="nvidia">
         <a-cone radius-bottom="0.01" radius-top="0.05" height="0.15" color="#00ff00" rotation="90 0 0"></a-cone>
         <a-text value="Nvidia" align="center" position="0 -0.15 0.2" scale="0.5 0.5 0.5" color="white"></a-text>
      </a-entity>

      <a-entity position="0.1 -0.5 0.1" class="clickable pin" data-id="intel">
         <a-cone radius-bottom="0.01" radius-top="0.05" height="0.15" color="#00aaff" rotation="90 0 0"></a-cone>
         <a-text value="Intel" align="center" position="0 -0.15 0.2" scale="0.5 0.5 0.5" color="white"></a-text>
      </a-entity>

    </a-entity>


    <a-entity 
      camera 
      look-controls="enabled: false"
      orbit-controls="target: 0 0.8 0; minDistance: 2; maxDistance: 5; initialPosition: 0 2.5 3.5; screenSpacePanning: true;">
    </a-entity>

  </a-scene>

  <script>
    // 生成木紋 (防止黑屏)
    const ctx = document.getElementById('wood-tex').getContext('2d');
    ctx.fillStyle = '#4e342e'; ctx.fillRect(0,0,512,512);
    ctx.strokeStyle = '#3e2723'; ctx.lineWidth = 3;
    for(let i=0;i<50;i++){ctx.beginPath();ctx.moveTo(0,Math.random()*512);ctx.bezierCurveTo(200,Math.random()*512,400,Math.random()*512,512,Math.random()*512);ctx.stroke();}

    // 互動數據
    const db = {
      samsung: { title: "NORTH CLUSTER", body: "Location: <span class='highlight'>Bac Ninh</span><br>Focus: Mobile & R&D<br><br>三星於此建立全球最大研發中心，利用鄰近中國的地理優勢進行供應鏈整合。" },
      nvidia: { title: "CENTRAL HUB", body: "Location: <span class='highlight'>Da Nang</span><br>Focus: AI Chip Design<br><br>Nvidia 與 FPT 合作，利用中部豐富的大學人才資源，打造 AI 晶片設計聚落。" },
      intel: { title: "SOUTH CLUSTER", body: "Location: <span class='highlight'>Ho Chi Minh (SHTP)</span><br>Focus: Packaging (ATM)<br><br>Intel 最大的封測廠所在地，具備最成熟的物流與電力基礎設施。" }
    };

    // 點擊事件
    const card = document.getElementById('info-card');
    document.querySelectorAll('.pin').forEach(p => {
      p.addEventListener('click', (e) => {
        e.stopPropagation();
        const d = db[p.getAttribute('data-id')];
        document.getElementById('n-title').innerHTML = d.title;
        document.getElementById('n-content').innerHTML = d.body;
        card.classList.add('active');
      });
    });

    // 關閉卡片
    document.querySelector('a-scene').addEventListener('click', (e) => {
      if(!e.target.closest('.clickable')) card.classList.remove('active');
    });
  </script>
</body>
</html>
